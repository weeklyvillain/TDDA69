rule
    fact($$number, $output)
    => {
        // Inside a block so nothing leaks to the global scope
        {
            define factorial = function ($n) {
                cond($n == 1, {return($n)}, {return($n * factorial($n-1))});
            }

            $output = factorial($number);
        }

    }